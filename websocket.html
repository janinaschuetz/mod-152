<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="bootstrap.min.css">
    <link href="node_modules/froala-editor/css/froala_editor.pkgd.min.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="node_modules/froala-editor/js/froala_editor.pkgd.min.js"></script>
    <title>Webchat</title>
</head>
<body>

<div class="form-group">
    <label for="username">Benutzername</label><br>
    <input type="text" id="username">

    <br>
    <br>

    <label for="content">Meine Nachricht</label><br>
    <textarea name="content" id="content" cols="50" rows="5"></textarea>
</div>
<button class="btn btn-success" onclick="sendMessageToServer()">Senden</button>

<br>
<br>

<div id="chat" class="fr-view">

</div>

<script>
    var editor = new FroalaEditor('#content');

    let wsClient = new WebSocket('ws://localhost:8080');

    function sendMessageToServer() {
        if ((document.querySelector('#username').value !== '') && (document.querySelector('#content').value !== '')) {
            //const valueToSend = document.querySelector('#username').value + ': ' + document.querySelector('#content').value;

            let msg = {
                content: document.querySelector('#content').value,
                username: document.querySelector('#username').value
            };

            wsClient.send(JSON.stringify(msg));

            // Blank the text input element, ready to receive the next line of text from the user.
            document.querySelector('#content').value = "";
        } else {
            alert("FÃ¼llen Sie die Felder Benutzername und Nachricht aus.");
        }
    }

    wsClient.onopen = function (event) {
        console.log("Connection established.");
        console.log(event);
    }

    wsClient.onmessage = function (event) {
        console.log("Message received.");
        console.log(event);
        document.querySelector('#chat').innerHTML += "<p>" + event.data + "</p><br>";
    }
</script>

</body>
</html>